{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,S,0BASuBC,WACrB,MAAMC,QAAmB,EAAAC,EAAAC,iBAEnBC,EAAWN,EAAAO,QAAUC,IAAI,YACzBC,EAAYT,EAAAO,QAAUC,IAAI,aAEhC,GAAIL,EAAY,CACdH,EAAAO,QAAUG,SAASJ,EAAU,QAC7BN,EAAAO,QAAUG,SAASD,EAAW,QAE9B,MAAME,QAAkB,EAAAP,EAAAQ,gBAEFC,WAAWC,SAASC,eAAe,aAC3CC,UAAYL,EAE1B,MAAMM,OAAEA,EAAMC,SAAEA,GAAaL,WAAWC,SAASK,SAC3CC,EAAUH,EAASC,EAAW,IAAMP,EACpCU,EAAcR,WAAWC,SAASC,eACtC,WAEFM,EAAYC,KAAOF,EACnBC,EAAYL,UAAYI,CAC1B,KAAO,CACLpB,EAAAO,QAAUG,SAASJ,EAAU,QAC7BN,EAAAO,QAAUG,SAASD,EAAW,QAE9B,MAAMc,EAAeT,SAASC,eAAe,iBAC7CQ,EAAaC,QAAWC,IACtBA,EAAMC,iBACNH,EAAaI,aAAa,WAAY,YACtC,MAAMC,EAAOd,SAAUC,eAAe,eACnCc,MACGC,EAAQhB,SACHC,eAAe,gBACxBc,OAEF,EAAAzB,EAAA2B,oBACGC,MAAK,MACJ,EAAAC,EAAAC,YAAW,C,KAAEN,E,MAAME,IAASE,MAAK,KAC/BnB,WAAWsB,MAAM,6BACjBtB,WAAWC,SAASK,SAASiB,QAAM,GACrC,IAEDC,OAAM,KACLC,EAAaC,gBAAgB,cAC/B,EAGJ,MAAMD,EAAexB,SAASC,eAAe,iBAC7CuB,EAAad,QAAWC,IACtBA,EAAMC,iBACNH,EAAaI,aAAa,WAAY,YACtC,MAAMa,EAAa1B,SACRC,eAAe,qBACxBc,OAEF,EAAAzB,EAAAqC,eAAc,C,WAAED,IACbR,MAAK,KACJnB,WAAWsB,MAAM,oCACjBtB,WAAWC,SAASK,SAASiB,QAAM,IAEpCC,OAAM,KACLC,EAAaC,gBAAgB,cAC/B,CAEN,GAEFG","sources":["src/startup.ts"],"sourcesContent":["import * as L from \"leaflet\";\nimport {\n  createPrivateKey,\n  getPublicKey,\n  hasPrivateKey,\n  setPrivateKey,\n} from \"./nostr/keys\";\nimport { setProfile } from \"./nostr/profiles\";\n\nexport const startup = async () => {\n  const isLoggedIn = await hasPrivateKey();\n\n  const loggedIn = L.DomUtil.get(\"loggedIn\")!;\n  const loggedOut = L.DomUtil.get(\"loggedOut\")!;\n\n  if (isLoggedIn) {\n    L.DomUtil.addClass(loggedIn, \"show\");\n    L.DomUtil.addClass(loggedOut, \"hide\");\n\n    const publicKey = await getPublicKey();\n\n    const publicKeySpan = globalThis.document.getElementById(\"publicKey\")!;\n    publicKeySpan.innerText = publicKey;\n\n    const { origin, pathname } = globalThis.document.location;\n    const yourUrl = origin + pathname + \"#\" + publicKey;\n    const yourUrlHref = globalThis.document.getElementById(\n      \"yourUrl\"\n    ) as HTMLLinkElement;\n    yourUrlHref.href = yourUrl;\n    yourUrlHref.innerText = yourUrl;\n  } else {\n    L.DomUtil.addClass(loggedIn, \"hide\");\n    L.DomUtil.addClass(loggedOut, \"show\");\n\n    const signupSubmit = document.getElementById(\"signup_submit\")!;\n    signupSubmit.onclick = (event) => {\n      event.preventDefault();\n      signupSubmit.setAttribute(\"disabled\", \"disabled\");\n      const name = (document.getElementById(\"signup_name\") as HTMLInputElement)\n        .value;\n      const about = (\n        document.getElementById(\"signup_about\") as HTMLInputElement\n      ).value;\n\n      createPrivateKey()\n        .then(() => {\n          setProfile({ name, about }).then(() => {\n            globalThis.alert(\"Your account was created.\");\n            globalThis.document.location.reload();\n          });\n        })\n        .catch(() => {\n          signinSubmit.removeAttribute(\"disabled\");\n        });\n    };\n\n    const signinSubmit = document.getElementById(\"signin_submit\")!;\n    signinSubmit.onclick = (event) => {\n      event.preventDefault();\n      signupSubmit.setAttribute(\"disabled\", \"disabled\");\n      const privateKey = (\n        document.getElementById(\"signin_privateKey\") as HTMLInputElement\n      ).value;\n\n      setPrivateKey({ privateKey })\n        .then(() => {\n          globalThis.alert(\"You were signed in successfully.\");\n          globalThis.document.location.reload();\n        })\n        .catch(() => {\n          signinSubmit.removeAttribute(\"disabled\");\n        });\n    };\n  }\n};\nstartup();\n"],"names":["$8JYDX","parcelRequire","async","isLoggedIn","$lsWS8","hasPrivateKey","loggedIn","DomUtil","get","loggedOut","addClass","publicKey","getPublicKey","globalThis","document","getElementById","innerText","origin","pathname","location","yourUrl","yourUrlHref","href","signupSubmit","onclick","event","preventDefault","setAttribute","name","value","about","createPrivateKey","then","$8JDfT","setProfile","alert","reload","catch","signinSubmit","removeAttribute","privateKey","setPrivateKey","$c68123b027adfc04$export$26a1f54597e2915b"],"version":3,"file":"index.2eb87215.js.map"}